---
- block:
  - apache2_module:
    state: absent
    name: 000-default.conf

  - apache2_module:
    state: absent
    name: default-ssl

  - apache2_module:
    state: present
    name: site.conf

#  - name: Deactivates the default virtualhost
#    command: a2dissite 000-default.conf

#  - name: Deactivates the default ssl virtualhost
#    command: a2dissite default-ssl

#  - name: Activates our virtualhost
#    command: a2ensite site.conf
  notify: Restart service apache2